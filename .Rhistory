# save LTR line graph with the created plot path
ggsave(graph_path, plot = lineGraph_LTR, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc != "R"] <- graph_path
# If type is 'E', create and save RTL graph
if (data_subset$type[1] == "E") {
RTL_graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_R_",data_subset$type[1], ".png")
lineGraph_RTL <- create_line_graph_RTL(data_subset)
ggsave(RTL_graph_path, plot = lineGraph_RTL, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc == "R"] <- RTL_graph_path
}
}
for (i in unique(data$item_no)) {
data_subset <- is_data %>% filter(item_no == i)
# to set the path of the plot: the direction based on type
direction <- ifelse(data_subset$type[1] == "E", "L_", "")
# Generate file path for LTR graph
graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_", direction, data_subset$type[1], ".png")
# Create LTR line graph
lineGraph_LTR <- create_line_graph_LTR(data_subset)
# save LTR line graph with the created plot path
ggsave(graph_path, plot = lineGraph_LTR, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc != "R"] <- graph_path
# If type is 'E', create and save RTL graph
if (data_subset$type[1] == "E") {
RTL_graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_R_",data_subset$type[1], ".png")
lineGraph_RTL <- create_line_graph_RTL(data_subset)
ggsave(RTL_graph_path, plot = lineGraph_RTL, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc == "R"] <- RTL_graph_path
}
}
theme_minimal(base_size = 10) +
theme(
panel.background = element_blank(),
plot.background = element_rect(color = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(size = 16, face = "bold", vjust = -1),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.y.left  = element_text(size = 18, angle = 90, vjust = 6),
axis.title.x = element_text(size = 18, vjust = -0.5),
plot.margin = margin(l=1,r=1,t=0.75,b=0.5, unit ="cm"),
aspect.ratio = 3/4,
axis.line = element_line(
arrow = arrow(angle = 20,
length = unit(0.3, "inches"),
# ends = "last",
type = "closed"),
linewidth = 1
),
axis.ticks = element_line ()
)
# Define a custom theme for plots
my_theme <- function() {
theme_minimal(base_size = 10) +
theme(
panel.background = element_blank(),
plot.background = element_rect(color = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(size = 16, face = "bold", vjust = -1),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.y.left  = element_text(size = 18, angle = 90, vjust = 6),
axis.title.x = element_text(size = 18, vjust = -0.5),
plot.margin = margin(l=1,r=1,t=0.75,b=0.5, unit ="cm"),
aspect.ratio = 3/4,
axis.line = element_line(
arrow = arrow(angle = 20,
length = unit(0.3, "inches"),
# ends = "last",
type = "closed"),
linewidth = 1
),
axis.ticks = element_line ()
)
}
create_line_graph_LTR <- function(data_row) {
data_row$x_labels <- factor(data_row$x_labels, levels = unique(data_row$x_labels))
ymin <- as.numeric(data_row$y_min_limit[1])
ymax <- as.numeric(data_row$y_max_limit[1])
xmin <- 1
xmax <- length(levels(data_row$x_labels))
ggplot(data_row, aes(x = x_labels, y = data_points, group = 1)) +
geom_line(linewidth = 2) +
geom_point(size = 2) +
labs(x = data_row$x_title[1], y = data_row$y_title[1]) +
scale_y_continuous(limits = c(ymin, ymax * 1.1),
breaks = seq(ymin, ymax, length.out = 5),
labels = scales::number_format(accuracy = 1, big.mark = ",")) +
my_theme()
}
create_line_graph_RTL <- function(data_row) {
data_row$x_labels <- factor(data_row$x_labels, levels = rev(unique(data_row$x_labels)))
ymin <- as.numeric(data_row$y_min_limit[1])
ymax <- as.numeric(data_row$y_max_limit[1])
xmin <- 1
xmax <- length(levels(data_row$x_labels))
ggplot(data_row, aes(x = x_labels, y = data_points, group = 1)) +
geom_line(linewidth = 2) +
geom_point(size = 2) +
labs(x = data_row$x_title[1], y = data_row$y_title[1]) +
scale_y_continuous(limits = c(ymin, ymax * 1.1),
breaks = seq(ymin, ymax, length.out = 5),
labels = scales::number_format(accuracy = 1, big.mark = ","),
position = "right") +
my_theme() +
theme(
axis.line.x = element_line(
arrow = arrow(angle = 20,
length = unit(0.3, "inches"),
ends = "first",   # ← بدل last
type = "closed"),
linewidth = 1
),
# السهم حق محور Y يظل فوق عادي
axis.line.y = element_line(
arrow = arrow(angle = 20,
length = unit(0.3, "inches"),
#ends = "last",
type = "closed"),
linewidth = 1
)
)
}
# duplicate the row for each E item
data <- data %>%
rbind(filter(data, type == "E")) %>%
arrange(item_no)%>%
mutate(
direc = case_when(
type == "E" ~ rep_len(c("R", "L"), length.out = nrow(.)),  # Alternates between "R" and "L"
type %in% c("F", "P", "A","i") ~ ""  # Sets empty string "" for "F", "P", "i" and "A" type of item
),   plot_path = "")
dir.create("arrow_Plots", showWarnings = FALSE)
for (i in unique(data$item_no)) {
data_subset <- is_data %>% filter(item_no == i)
# to set the path of the plot: the direction based on type
direction <- ifelse(data_subset$type[1] == "E", "L_", "")
# Generate file path for LTR graph
graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_", direction, data_subset$type[1], ".png")
# Create LTR line graph
lineGraph_LTR <- create_line_graph_LTR(data_subset)
# save LTR line graph with the created plot path
ggsave(graph_path, plot = lineGraph_LTR, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc != "R"] <- graph_path
# If type is 'E', create and save RTL graph
if (data_subset$type[1] == "E") {
RTL_graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_R_",data_subset$type[1], ".png")
lineGraph_RTL <- create_line_graph_RTL(data_subset)
ggsave(RTL_graph_path, plot = lineGraph_RTL, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc == "R"] <- RTL_graph_path
}
}
# Define a custom theme for plots
my_theme <- function() {
theme_minimal(base_size = 10) +
theme(
panel.background = element_blank(),
plot.background = element_rect(color = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(size = 16, face = "bold", vjust = -1),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.y.left  = element_text(size = 18, angle = 90, vjust = 6),
axis.title.x = element_text(size = 18, vjust = -0.5),
plot.margin = margin(l=1,r=1,t=0.75,b=0.5, unit ="cm"),
aspect.ratio = 3/4,
axis.line = element_line(
arrow = arrow(angle = 20,
length = unit(0.1, "inches"),
# ends = "last",
type = "closed"),
linewidth = 1
),
axis.ticks = element_line ()
)
}
create_line_graph_LTR <- function(data_row) {
data_row$x_labels <- factor(data_row$x_labels, levels = unique(data_row$x_labels))
ymin <- as.numeric(data_row$y_min_limit[1])
ymax <- as.numeric(data_row$y_max_limit[1])
xmin <- 1
xmax <- length(levels(data_row$x_labels))
ggplot(data_row, aes(x = x_labels, y = data_points, group = 1)) +
geom_line(linewidth = 2) +
geom_point(size = 2) +
labs(x = data_row$x_title[1], y = data_row$y_title[1]) +
scale_y_continuous(limits = c(ymin, ymax * 1.1),
breaks = seq(ymin, ymax, length.out = 5),
labels = scales::number_format(accuracy = 1, big.mark = ",")) +
my_theme()
}
create_line_graph_RTL <- function(data_row) {
data_row$x_labels <- factor(data_row$x_labels, levels = rev(unique(data_row$x_labels)))
ymin <- as.numeric(data_row$y_min_limit[1])
ymax <- as.numeric(data_row$y_max_limit[1])
xmin <- 1
xmax <- length(levels(data_row$x_labels))
ggplot(data_row, aes(x = x_labels, y = data_points, group = 1)) +
geom_line(linewidth = 2) +
geom_point(size = 2) +
labs(x = data_row$x_title[1], y = data_row$y_title[1]) +
scale_y_continuous(limits = c(ymin, ymax * 1.1),
breaks = seq(ymin, ymax, length.out = 5),
labels = scales::number_format(accuracy = 1, big.mark = ","),
position = "right") +
my_theme() +
theme(
axis.line.x = element_line(
arrow = arrow(angle = 20,
length = unit(0.1, "inches"),
ends = "first",   # ← بدل last
type = "closed"),
linewidth = 1
),
# السهم حق محور Y يظل فوق عادي
axis.line.y = element_line(
arrow = arrow(angle = 20,
length = unit(0.1, "inches"),
#ends = "last",
type = "closed"),
linewidth = 1
)
)
}
# duplicate the row for each E item
data <- data %>%
rbind(filter(data, type == "E")) %>%
arrange(item_no)%>%
mutate(
direc = case_when(
type == "E" ~ rep_len(c("R", "L"), length.out = nrow(.)),  # Alternates between "R" and "L"
type %in% c("F", "P", "A","i") ~ ""  # Sets empty string "" for "F", "P", "i" and "A" type of item
),   plot_path = "")
dir.create("arrow_Plots", showWarnings = FALSE)
for (i in unique(data$item_no)) {
data_subset <- is_data %>% filter(item_no == i)
# to set the path of the plot: the direction based on type
direction <- ifelse(data_subset$type[1] == "E", "L_", "")
# Generate file path for LTR graph
graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_", direction, data_subset$type[1], ".png")
# Create LTR line graph
lineGraph_LTR <- create_line_graph_LTR(data_subset)
# save LTR line graph with the created plot path
ggsave(graph_path, plot = lineGraph_LTR, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc != "R"] <- graph_path
# If type is 'E', create and save RTL graph
if (data_subset$type[1] == "E") {
RTL_graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_R_",data_subset$type[1], ".png")
lineGraph_RTL <- create_line_graph_RTL(data_subset)
ggsave(RTL_graph_path, plot = lineGraph_RTL, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc == "R"] <- RTL_graph_path
}
}
theme_minimal(base_size = 10) +
theme(
panel.background = element_blank(),
plot.background = element_rect(color = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(size = 16, face = "bold", vjust = -1),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.y  = element_text(size = 18, angle = 90, vjust = 6),
axis.title.x = element_text(size = 18, vjust = -0.5),
plot.margin = margin(l=1,r=1,t=0.75,b=0.5, unit ="cm"),
aspect.ratio = 3/4,
axis.line = element_line(
arrow = arrow(angle = 20,
length = unit(0.2, "inches"),
# ends = "last",
type = "closed"),
linewidth = 1
),
axis.ticks = element_line ()
)
# Define a custom theme for plots
my_theme <- function() {
theme_minimal(base_size = 10) +
theme(
panel.background = element_blank(),
plot.background = element_rect(color = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(size = 16, face = "bold", vjust = -1),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.y  = element_text(size = 18, angle = 90, vjust = 6),
axis.title.x = element_text(size = 18, vjust = -0.5),
plot.margin = margin(l=1,r=1,t=0.75,b=0.5, unit ="cm"),
aspect.ratio = 3/4,
axis.line = element_line(
arrow = arrow(angle = 20,
length = unit(0.2, "inches"),
# ends = "last",
type = "closed"),
linewidth = 1
),
axis.ticks = element_line ()
)
}
create_line_graph_LTR <- function(data_row) {
data_row$x_labels <- factor(data_row$x_labels, levels = unique(data_row$x_labels))
ymin <- as.numeric(data_row$y_min_limit[1])
ymax <- as.numeric(data_row$y_max_limit[1])
xmin <- 1
xmax <- length(levels(data_row$x_labels))
ggplot(data_row, aes(x = x_labels, y = data_points, group = 1)) +
geom_line(linewidth = 2) +
geom_point(size = 2) +
labs(x = data_row$x_title[1], y = data_row$y_title[1]) +
scale_y_continuous(limits = c(ymin, ymax * 1.1),
breaks = seq(ymin, ymax, length.out = 5),
labels = scales::number_format(accuracy = 1, big.mark = ",")) +
my_theme()
}
create_line_graph_RTL <- function(data_row) {
data_row$x_labels <- factor(data_row$x_labels, levels = rev(unique(data_row$x_labels)))
ymin <- as.numeric(data_row$y_min_limit[1])
ymax <- as.numeric(data_row$y_max_limit[1])
xmin <- 1
xmax <- length(levels(data_row$x_labels))
ggplot(data_row, aes(x = x_labels, y = data_points, group = 1)) +
geom_line(linewidth = 2) +
geom_point(size = 2) +
labs(x = data_row$x_title[1], y = data_row$y_title[1]) +
scale_y_continuous(limits = c(ymin, ymax * 1.1),
breaks = seq(ymin, ymax, length.out = 5),
labels = scales::number_format(accuracy = 1, big.mark = ","),
position = "right") +
my_theme() +
theme(
axis.line.x = element_line(
arrow = arrow(angle = 20,
length = unit(0.1, "inches"),
ends = "first",   # ← بدل last
type = "closed"),
linewidth = 1
),
# السهم حق محور Y يظل فوق عادي
axis.line.y = element_line(
arrow = arrow(angle = 20,
length = unit(0.2, "inches"),
#ends = "last",
type = "closed"),
linewidth = 1
)
)
}
# duplicate the row for each E item
data <- data %>%
rbind(filter(data, type == "E")) %>%
arrange(item_no)%>%
mutate(
direc = case_when(
type == "E" ~ rep_len(c("R", "L"), length.out = nrow(.)),  # Alternates between "R" and "L"
type %in% c("F", "P", "A","i") ~ ""  # Sets empty string "" for "F", "P", "i" and "A" type of item
),   plot_path = "")
dir.create("arrow_Plots", showWarnings = FALSE)
for (i in unique(data$item_no)) {
data_subset <- is_data %>% filter(item_no == i)
# to set the path of the plot: the direction based on type
direction <- ifelse(data_subset$type[1] == "E", "L_", "")
# Generate file path for LTR graph
graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_", direction, data_subset$type[1], ".png")
# Create LTR line graph
lineGraph_LTR <- create_line_graph_LTR(data_subset)
# save LTR line graph with the created plot path
ggsave(graph_path, plot = lineGraph_LTR, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc != "R"] <- graph_path
# If type is 'E', create and save RTL graph
if (data_subset$type[1] == "E") {
RTL_graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_R_",data_subset$type[1], ".png")
lineGraph_RTL <- create_line_graph_RTL(data_subset)
ggsave(RTL_graph_path, plot = lineGraph_RTL, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc == "R"] <- RTL_graph_path
}
}
theme_minimal(base_size = 10) +
theme(
panel.background = element_blank(),
plot.background = element_rect(color = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(size = 16, face = "bold", vjust = -1),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.y  = element_text(size = 18, angle = 90),
axis.title.x = element_text(size = 18, vjust = -0.5),
plot.margin = margin(l=1,r=1,t=0.75,b=0.5, unit ="cm"),
aspect.ratio = 3/4,
axis.line = element_line(
arrow = arrow(angle = 20,
length = unit(0.2, "inches"),
# ends = "last",
type = "closed"),
linewidth = 1
),
axis.ticks = element_line ()
)
# Define a custom theme for plots
my_theme <- function() {
theme_minimal(base_size = 10) +
theme(
panel.background = element_blank(),
plot.background = element_rect(color = "white"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.x = element_text(size = 16, face = "bold", vjust = -1),
axis.text.y = element_text(size = 16, face = "bold"),
axis.title.y  = element_text(size = 18, angle = 90),
axis.title.x = element_text(size = 18, vjust = -0.5),
plot.margin = margin(l=1,r=1,t=0.75,b=0.5, unit ="cm"),
aspect.ratio = 3/4,
axis.line = element_line(
arrow = arrow(angle = 20,
length = unit(0.2, "inches"),
# ends = "last",
type = "closed"),
linewidth = 1
),
axis.ticks = element_line ()
)
}
create_line_graph_LTR <- function(data_row) {
data_row$x_labels <- factor(data_row$x_labels, levels = unique(data_row$x_labels))
ymin <- as.numeric(data_row$y_min_limit[1])
ymax <- as.numeric(data_row$y_max_limit[1])
xmin <- 1
xmax <- length(levels(data_row$x_labels))
ggplot(data_row, aes(x = x_labels, y = data_points, group = 1)) +
geom_line(linewidth = 2) +
geom_point(size = 2) +
labs(x = data_row$x_title[1], y = data_row$y_title[1]) +
scale_y_continuous(limits = c(ymin, ymax * 1.1),
breaks = seq(ymin, ymax, length.out = 5),
labels = scales::number_format(accuracy = 1, big.mark = ",")) +
my_theme()
}
create_line_graph_RTL <- function(data_row) {
data_row$x_labels <- factor(data_row$x_labels, levels = rev(unique(data_row$x_labels)))
ymin <- as.numeric(data_row$y_min_limit[1])
ymax <- as.numeric(data_row$y_max_limit[1])
xmin <- 1
xmax <- length(levels(data_row$x_labels))
ggplot(data_row, aes(x = x_labels, y = data_points, group = 1)) +
geom_line(linewidth = 2) +
geom_point(size = 2) +
labs(x = data_row$x_title[1], y = data_row$y_title[1]) +
scale_y_continuous(limits = c(ymin, ymax * 1.1),
breaks = seq(ymin, ymax, length.out = 5),
labels = scales::number_format(accuracy = 1, big.mark = ","),
position = "right") +
my_theme() +
theme(
axis.line.x = element_line(
arrow = arrow(angle = 20,
length = unit(0.2, "inches"),
ends = "first",   # ← بدل last
type = "closed"),
linewidth = 1
),
# السهم حق محور Y يظل فوق عادي
axis.line.y = element_line(
arrow = arrow(angle = 20,
length = unit(0.2, "inches"),
#ends = "last",
type = "closed"),
linewidth = 1
)
)
}
# duplicate the row for each E item
data <- data %>%
rbind(filter(data, type == "E")) %>%
arrange(item_no)%>%
mutate(
direc = case_when(
type == "E" ~ rep_len(c("R", "L"), length.out = nrow(.)),  # Alternates between "R" and "L"
type %in% c("F", "P", "A","i") ~ ""  # Sets empty string "" for "F", "P", "i" and "A" type of item
),   plot_path = "")
# duplicate the row for each E item
data <- data %>%
rbind(filter(data, type == "E")) %>%
arrange(item_no)%>%
mutate(
direc = case_when(
type == "E" ~ rep_len(c("R", "L"), length.out = nrow(.)),  # Alternates between "R" and "L"
type %in% c("F", "P", "A","i") ~ ""  # Sets empty string "" for "F", "P", "i" and "A" type of item
),   plot_path = "")
dir.create("arrow_Plots", showWarnings = FALSE)
for (i in unique(data$item_no)) {
data_subset <- is_data %>% filter(item_no == i)
# to set the path of the plot: the direction based on type
direction <- ifelse(data_subset$type[1] == "E", "L_", "")
# Generate file path for LTR graph
graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_", direction, data_subset$type[1], ".png")
# Create LTR line graph
lineGraph_LTR <- create_line_graph_LTR(data_subset)
# save LTR line graph with the created plot path
ggsave(graph_path, plot = lineGraph_LTR, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc != "R"] <- graph_path
# If type is 'E', create and save RTL graph
if (data_subset$type[1] == "E") {
RTL_graph_path <- paste0("arrow_Plots/plot_", data_subset$item_no[1],"_R_",data_subset$type[1], ".png")
lineGraph_RTL <- create_line_graph_RTL(data_subset)
ggsave(RTL_graph_path, plot = lineGraph_RTL, width = 7, height = 5, units = "in", dpi = 100)
data$plot_path[data$item_no == i & data$direc == "R"] <- RTL_graph_path
}
}
# Load necessary libraries
library(tidyverse)
library(dplyr)
library(ggplot2)
library(scales)
library(readr)
